import{y as I}from"./articles-Cl6OgbpY.js";import{d as D,e as R,i,E as s,j as e,t as h,_ as w,r as m,o as V,G as g,l as C,F as x,q as B,k as E}from"./index-Cha8mMNk.js";import{A as M,a as U}from"./AdminHideDialog-DuXs6nFb.js";const L={class:"comment-block"},N={class:"comment-header"},S={class:"user-info"},T={class:"user-name-row"},j={class:"comment-time"},F={class:"comment-content"},O={class:"comment-text"},q=D({__name:"AdminCommentBlock",props:{comment:{}},emits:["userClick"],setup(k,{emit:n}){const c=k,u=R(()=>{const a=typeof c.comment.createdAt=="string"?new Date(c.comment.createdAt):c.comment.createdAt,f=new Date().getTime()-a.getTime(),p=Math.floor(f/(1e3*60)),y=Math.floor(f/(1e3*60*60)),_=Math.floor(f/(1e3*60*60*24));return p<1?"just now":p<60?`${p} min ago`:y<24?`${y} h ago`:_===1?"yesterday":_<7?`${_} days ago`:a.toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:"numeric"})}),d=n;function r(){d("userClick",c.comment.author.id)}return(a,v)=>(s(),i("div",L,[e("div",N,[e("div",{class:"user-avatar",onClick:r},[...v[0]||(v[0]=[e("div",{class:"avatar-placeholder"},null,-1)])]),e("div",S,[e("div",T,[e("h3",{class:"username",onClick:r},h(k.comment.author.username),1),e("span",j,h(u.value),1)])])]),e("div",F,[e("p",O,h(k.comment.text),1)])]))}}),G=w(q,[["__scopeId","data-v-868fbe36"]]),P={class:"admin-section"},z={class:"section-header"},J={key:0,class:"badge"},K={key:0,class:"loading"},Q={key:1,class:"empty"},W={key:2,class:"stack"},X={class:"reason"},Y={class:"reason-text"},Z={class:"actions"},ee=["onClick"],te=["onClick"],ne=D({__name:"AdminReportedComments",setup(k){const n=m([]),c=m(!0),u=m(!1),d=m(null),r=m(!1),a=m(null);V(async()=>{try{const t=await I();n.value=t}finally{c.value=!1}});function v(t){return{id:t.id,author:{id:0,username:"Reported"},text:t.content,createdAt:new Date().toISOString(),likes:0,dislikes:0,userLiked:!1}}function f(t){d.value=t.id,u.value=!0}function p(t){d.value!=null&&(n.value=n.value.filter(o=>o.id!==d.value)),d.value=null;try{document.dispatchEvent(new CustomEvent("app-toast",{detail:{severity:"success",summary:"Comment deleted",detail:t?`Reason: ${t}`:"Deleted successfully",life:3500}}))}catch{}}function y(){d.value=null}function _(t){window.open(`/profile/${t}`,"_blank")}function $(t){a.value=t.id,r.value=!0}function A(){a.value!=null&&(n.value=n.value.filter(t=>t.id!==a.value)),a.value=null;try{document.dispatchEvent(new CustomEvent("app-toast",{detail:{severity:"success",summary:"Comment hidden",detail:"Hidden successfully",life:3500}}))}catch{}}function b(){a.value=null}return(t,o)=>(s(),i("div",P,[e("div",z,[o[2]||(o[2]=e("h2",null,"Reported comments",-1)),n.value.length?(s(),i("span",J,h(n.value.length),1)):C("",!0)]),c.value?(s(),i("div",K,"Loading...")):n.value.length?(s(),i("div",W,[(s(!0),i(x,null,B(n.value,l=>(s(),i("div",{class:"comment-wrapper",key:l.id},[E(G,{comment:v(l),onUserClick:_},null,8,["comment"]),e("div",X,[o[3]||(o[3]=e("div",{class:"reason-chip"},"Reason:",-1)),e("div",Y,h(l.reportReason),1),e("div",Z,[e("button",{class:"btn subtle",onClick:H=>$(l)},"Hide",8,ee),e("button",{class:"btn danger",onClick:H=>f(l)},"Delete",8,te)])])]))),128))])):(s(),i("div",Q,"No reports")),u.value?(s(),g(M,{key:3,modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=l=>u.value=l),onConfirm:p,onCancel:y},null,8,["modelValue"])):C("",!0),r.value?(s(),g(U,{key:4,modelValue:r.value,"onUpdate:modelValue":o[1]||(o[1]=l=>r.value=l),onConfirm:A,onCancel:b},null,8,["modelValue"])):C("",!0)]))}}),le=w(ne,[["__scopeId","data-v-493d576a"]]);export{le as default};
