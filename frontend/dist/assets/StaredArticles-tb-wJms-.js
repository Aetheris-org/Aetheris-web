import{d as U,u as V,c as j,a as M,r as l,e as f,V as z,o as G,D as Y,f as H,i as c,j as o,k as C,l as b,t as d,F as J,q as K,s as R,m as O,z as Q,E as i,G as W,_ as X}from"./index-Cha8mMNk.js";import{s as Z}from"./index-BTgU_lKo.js";import{A as ee}from"./ArticleCard-CYaLlIwp.js";import{m as te}from"./articles-Cl6OgbpY.js";import"./index-CIrCQqjO.js";import"./DeleteConfirmDialog-CrHiTmEy.js";const oe={class:"stared-articles-page"},se={class:"page-container"},re={class:"page-header"},ae={class:"page-title"},ie={key:0,class:"page-subtitle"},ne={class:"articles-list-container"},le={key:0,class:"loading-container"},ce={class:"loading-text"},ue={key:1,class:"empty-state"},de={key:3,class:"pagination-container"},me=U({__name:"StaredArticles",setup(he){function F(e,t=1400){if(!e)return"";const s=e.replace(/<[^>]+>/g,"");return s.length>t?s.slice(0,t).trimEnd():s}function L(e){let t,s;return e.author_id?t=Number(e.author_id):e.author?.id?t=Number(e.author.id):typeof e.author=="object"&&e.author.username&&(t=void 0),e.author?.username?s=e.author.username:typeof e.author=="string"?s=e.author:s=`User ${e.author||"Unknown"}`,{id:e.id,title:e.title,content:e.content,excerpt:e.excerpt||F(e.content),author:{id:t||0,username:s},tags:Array.isArray(e.tags)?e.tags:typeof e.tags=="string"?e.tags.split(","):[],createdAt:e.created_at||e.createdAt,updatedAt:e.updated_at||e.updatedAt||e.modified_at||e.modifiedAt,status:e.status||"published",difficulty:e.difficulty||"medium",likes:e.likes??0,dislikes:e.dislikes??0,commentsCount:e.comments_count??e.commentsCount??0,userReaction:e.user_reaction??null,previewImage:e.preview_image||e.previewImage||null,author_id:t||e.author_id||void 0}}const{t:r}=V(),u=Y(),m=j(),h=M(),a=l([]),n=l(!1),p=l(null),v=l(0),k=l(10),w=l(!1),g=f(()=>!n.value&&a.value.length===0),y=f(()=>a.value.length),S=f(()=>{const e=y.value;return z()==="ru"?e%10===1&&e%100!==11?r("common.totalFavorites_one",{count:e}):[2,3,4].includes(e%10)&&![12,13,14].includes(e%100)?r("common.totalFavorites_few",{count:e}):r("common.totalFavorites_many",{count:e}):e===1?r("common.totalFavorites_one",{count:e}):r("common.totalFavorites_other",{count:e})}),x=f(()=>{const e=v.value,t=e+k.value;return a.value.slice(e,t)}),B=async()=>{if(!h.isAuthenticated||!h.user){p.value="Authentication required";return}n.value=!0,p.value=null;try{const e=await te(0,1e3);console.log("ðŸ“š Raw bookmarked articles from API:",e),a.value=e.map(L),console.log("âœ… Mapped bookmarked articles:",a.value)}catch(e){console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¸Ð·Ð±Ñ€Ð°Ð½Ð½Ñ‹Ñ… ÑÑ‚Ð°Ñ‚ÐµÐ¹:",e),p.value=e.response?.data?.detail||e.message||"Failed to load bookmarked articles",m.add({severity:"error",summary:r("notifications.error.summary","ÐžÑˆÐ¸Ð±ÐºÐ°"),detail:p.value,life:4e3})}finally{n.value=!1}},P=e=>{u.push(`/?tag=${encodeURIComponent(e)}`)},T=e=>{u.push(`/user/${e}`)},$=e=>{if(!h.isAuthenticated){m.add({severity:"warn",summary:r("notifications.authRequired.summary"),detail:r("notifications.authRequired.detail"),life:4e3}),u.push("/auth");return}u.push(`/article/${e}`)},D=e=>{a.value=a.value.filter(t=>t.id!==e),m.add({severity:"success",summary:r("notifications.deleteArticle.success.summary","Ð¡Ñ‚Ð°Ñ‚ÑŒÑ ÑƒÐ´Ð°Ð»ÐµÐ½Ð°"),detail:r("notifications.deleteArticle.success.detail","Ð¡Ñ‚Ð°Ñ‚ÑŒÑ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ ÑƒÐ´Ð°Ð»ÐµÐ½Ð°"),life:3e3})},E=e=>{console.log("Delete article:",e)},I=e=>{console.log("Report article:",e)},q=e=>{console.log("Share article:",e)},N=e=>{v.value=e.first,A()},A=()=>{window.scrollTo({top:0,behavior:"smooth"})},_=()=>{w.value=window.scrollY>300};return G(async()=>{if(window.addEventListener("scroll",_),!h.isAuthenticated){m.add({severity:"warn",summary:r("notifications.authRequired.summary"),detail:r("notifications.authRequired.detail"),life:4e3}),u.push("/auth");return}await B()}),H(()=>{window.removeEventListener("scroll",_)}),(e,t)=>(i(),c("div",oe,[o("div",se,[o("div",re,[o("h1",ae,d(e.$t("common.favorites","Ð˜Ð·Ð±Ñ€Ð°Ð½Ð½Ð¾Ðµ")),1),!n.value&&!g.value?(i(),c("p",ie,d(S.value),1)):b("",!0)]),o("div",ne,[n.value?(i(),c("div",le,[t[1]||(t[1]=o("div",{class:"loading-spinner"},null,-1)),o("p",ce,d(e.$t("common.loading","Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°...")),1)])):g.value?(i(),c("div",ue,[t[2]||(t[2]=o("div",{class:"empty-state-icon"},[o("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",fill:"none"})])],-1)),o("h3",null,d(e.$t("bookmarks.empty.title","Ð£ Ð²Ð°Ñ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚ Ð¸Ð·Ð±Ñ€Ð°Ð½Ð½Ñ‹Ñ… ÑÑ‚Ð°Ñ‚ÐµÐ¹")),1),o("p",null,d(e.$t("bookmarks.empty.description","Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐ¹Ñ‚Ðµ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÐ½Ñ‹Ðµ ÑÑ‚Ð°Ñ‚ÑŒÐ¸ Ð² Ð¸Ð·Ð±Ñ€Ð°Ð½Ð½Ð¾Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ðµ Ð¿Ð¾Ñ‚ÐµÑ€ÑÑ‚ÑŒ Ð¸Ñ…")),1)])):(i(!0),c(J,{key:2},K(x.value,s=>(i(),W(ee,{key:s.id,article:s,onTagClick:P,onAuthorClick:T,onArticleClick:$,onArticleDeleted:D,onDeleteArticle:E,onReportArticle:I,onShareArticle:q},null,8,["article"]))),128)),!n.value&&!g.value?(i(),c("div",de,[C(R(Z),{first:v.value,"onUpdate:first":t[0]||(t[0]=s=>v.value=s),rows:k.value,totalRecords:y.value,template:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink",onPage:N},null,8,["first","rows","totalRecords"])])):b("",!0)]),o("button",{class:O(["back-to-top-btn",{visible:w.value}]),onClick:A},[...t[3]||(t[3]=[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M18 15l-6-6-6 6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])],2)]),C(R(Q))]))}}),Ae=X(me,[["__scopeId","data-v-cdcba5e2"]]);export{Ae as default};
