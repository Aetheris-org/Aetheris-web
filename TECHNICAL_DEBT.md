# Технический долг и временные решения

## Поиск и фильтрация статей

### ✅ ИСПРАВЛЕНО (2025-11-22)

**Проблема была:** Кастомный GraphQL resolver `searchArticles` не мог быть подключен из-за ошибки `schema.getType is not a function` при объединении resolver'ов в KeystoneJS 6.

**Решение:**
1. ✅ Создан файл `backend/keystonejs-backend/src/graphql/combined.ts` - объединяет все resolver'ы в одном `graphql.extend`
2. ✅ Кастомный resolver `searchArticles` подключен и работает
3. ✅ Фронтенд обновлен для использования кастомного resolver'а вместо клиентской фильтрации
4. ✅ Убрана клиентская фильтрация (костыль)
5. ✅ Поиск теперь работает по содержимому статей (через `extractTextFromSlateDocument`)

**Измененные файлы:**
- `backend/keystonejs-backend/src/graphql/combined.ts` - новый файл с объединенными resolver'ами
- `backend/keystonejs-backend/keystone.ts` - обновлен импорт resolver'ов
- `frontend-react/src/api/articles-graphql.ts` - переписан для использования кастомного resolver'а

### Соответствие требованиям text.text

**Теперь соответствует:**
- ✅ "Решай проблемы без технических долгов, колхозных решений и костылей" - костыли убраны
- ✅ "Предоставь ясные GraphQL API эндпоинты" - используется GraphQL resolver
- ✅ "без технических долгов" - технический долг исправлен
- ✅ Валидация через Zod (в кастомном resolver'е)
- ✅ Логирование через Winston
- ✅ Обработка ошибок
- ✅ Использование стандартных механизмов KeystoneJS

### Оставшиеся задачи (низкий приоритет)

1. **TODO: Добавить searchArticlesCount** - для точного подсчета total при использовании searchArticles
   - Сейчас используется `articles.length` как приблизительное значение
   - Можно добавить отдельный query или расширить searchArticles для возврата total

2. **Оптимизация производительности** - при большом количестве статей может потребоваться:
   - Индексация в базе данных для поиска
   - Кэширование результатов поиска
   - Пагинация на уровне базы данных (уже реализовано)

