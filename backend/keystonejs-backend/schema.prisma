// This file is automatically generated by Keystone, do not modify it manually.
// Modify your Keystone config when you want to change this.

datasource sqlite {
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
  provider          = "sqlite"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                      Int               @id @default(autoincrement())
  name                    String            @default("")
  email                   String            @unique @default("")
  password                String?
  username                String            @unique @default("")
  bio                     String            @default("")
  avatar                  String            @default("")
  coverImage              String            @default("")
  provider                String?           @default("local")
  confirmed               Boolean           @default(false)
  blocked                 Boolean           @default(false)
  role                    String            @default("user")
  articles                Article[]         @relation("Article_author")
  comments                Comment[]         @relation("Comment_author")
  articleReactions        ArticleReaction[] @relation("ArticleReaction_user")
  commentReactions        CommentReaction[] @relation("CommentReaction_user")
  createdAt               DateTime?         @default(now())
  updatedAt               DateTime?         @default(now())
  passwordResetToken      String?
  passwordResetIssuedAt   DateTime?
  passwordResetRedeemedAt DateTime?
  magicAuthToken          String?
  magicAuthIssuedAt       DateTime?
  magicAuthRedeemedAt     DateTime?
}

model Article {
  id             Int               @id @default(autoincrement())
  title          String            @default("")
  content        String            @default("[{\"type\":\"paragraph\",\"children\":[{\"text\":\"\"}]}]")
  excerpt        String            @default("")
  author         User?             @relation("Article_author", fields: [authorId], references: [id])
  authorId       Int?              @map("author")
  tags           String?
  difficulty     String            @default("medium")
  previewImage   String            @default("")
  likes_count    Int?              @default(0)
  dislikes_count Int?              @default(0)
  views          Int?              @default(0)
  comments       Comment[]         @relation("Comment_article")
  reactions      ArticleReaction[] @relation("ArticleReaction_article")
  publishedAt    DateTime?
  createdAt      DateTime?         @default(now())
  updatedAt      DateTime?         @default(now())

  @@index([title])
  @@index([authorId])
}

model Comment {
  id                  Int               @id @default(autoincrement())
  text                String            @default("")
  article             Article?          @relation("Comment_article", fields: [articleId], references: [id])
  articleId           Int?              @map("article")
  author              User?             @relation("Comment_author", fields: [authorId], references: [id])
  authorId            Int?              @map("author")
  parent              Comment?          @relation("Comment_parent", fields: [parentId], references: [id])
  parentId            Int?              @map("parent")
  likes_count         Int?              @default(0)
  dislikes_count      Int?              @default(0)
  reactions           CommentReaction[] @relation("CommentReaction_comment")
  createdAt           DateTime?         @default(now())
  updatedAt           DateTime?         @default(now())
  from_Comment_parent Comment[]         @relation("Comment_parent")

  @@index([articleId])
  @@index([authorId])
  @@index([parentId])
}

model ArticleReaction {
  id        Int       @id @default(autoincrement())
  article   Article?  @relation("ArticleReaction_article", fields: [articleId], references: [id])
  articleId Int?      @map("article")
  user      User?     @relation("ArticleReaction_user", fields: [userId], references: [id])
  userId    Int?      @map("user")
  reaction  String
  createdAt DateTime? @default(now())

  @@index([articleId])
  @@index([userId])
}

model CommentReaction {
  id        Int       @id @default(autoincrement())
  comment   Comment?  @relation("CommentReaction_comment", fields: [commentId], references: [id])
  commentId Int?      @map("comment")
  user      User?     @relation("CommentReaction_user", fields: [userId], references: [id])
  userId    Int?      @map("user")
  reaction  String
  createdAt DateTime? @default(now())

  @@index([commentId])
  @@index([userId])
}
